function showCaptcha(){var a=$(".sso_captcha");a.is(":visible")||a.show(),refreshCaptcha()}function getCookie(a){var e=null;if(document.cookie&&""!=document.cookie)for(var t=document.cookie.split(";"),c=0;c<t.length;c++){var r=jQuery.trim(t[c]);if(r.substring(0,a.length+1)==a+"="){e=decodeURIComponent(r.substring(a.length+1));break}}return e}function uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(a){var e=16*Math.random()|0;return("x"==a?e:3&e|8).toString(16)}))}function refreshCaptcha(){var a=CAPTCHA_SERVICE;SETTINGS.test&&(a=CAPTCHA_SERVICE_TEST),captcha_key=uuid().replace(/-/g,"");var e=$("#sso_captcha_image");e.is(":visible")&&$(e).find("img").attr("src",a+"?key="+captcha_key)}function hideCaptcha(){var a=$(".sso_captcha");a.is(":visible")&&(a.hide(),a.find("input").val(""))}var ReCaptchaWidgetIDMap={};function renderRecaptcha(a,e){if(a in ReCaptchaWidgetIDMap)grecaptcha.reset(ReCaptchaWidgetIDMap[a]);else{var t=grecaptcha.render(a,{sitekey:SETTINGS.recaptcha_site_key,callback:e});ReCaptchaWidgetIDMap[a]=t}}function getRecaptchaWrapperID(a){return"recaptcha_wrapper_"+a}function getGacaptchaWrapperID(a){return"gacaptcha_wrapper_"+a}function getShopeeCaptchaWrapperID(a){return"shopeecaptcha_wrapper_"+a}function centralizeCaptchaDialog(a){var e=a.find(".sso_dialog"),t=($(window).height()-e.height())/2;t<0&&(t=(e.height()-$(window).height())/2),e.css("top",t.toString()+"px")}function initCaptchaDialog(a,e){var t=$("<div/>",{class:"sso_captcha_dialog_container",id:"sso_captcha_dialog_container_"+a}).appendTo(e);$("<div/>").addClass("sso_dialog_background").appendTo(t);var c=$("<div/>",{class:"sso_dialog"}).appendTo(t),r=getRecaptchaWrapperID(a),p=($("<div/>",{class:"recaptcha-wrapper",id:r}).appendTo(c),getGacaptchaWrapperID(a)),o=$("<div/>",{class:"gacaptcha-wrapper",id:p}).appendTo(c),i=$("<div/>",{class:"line clearfix"}).appendTo(o),h=$("<div/>",{id:"line-captcha",class:"sso_captcha"}).appendTo(i);$("<input/>",{id:"input-captcha",name:"captcha",type:"text",placeholder:_("login_form_captcha_prompt"),autocorrect:"off",autocapitalize:"off"}).appendTo(h);var n=$("<div/>",{id:"sso_captcha_image",class:"clearfix sso_captcha"}).appendTo(i);$("<img/>").appendTo($("<span/>",{class:"code fl"}).appendTo(n)),$("<a/>",{href:"javascript:;",class:"refresh fl"}).text(_("refresh_captcha")).appendTo(n).click(refreshCaptcha);var s=$("<div/>",{class:"line clearfix"}).appendTo(o);$("<div/>",{text:_("btn_captcha_verify"),class:"btn",id:"proceed-gacaptcha"}).val(0).appendTo(s);var l=getShopeeCaptchaWrapperID(a);$("<div/>",{class:"shopeecaptcha-wrapper",id:l}).appendTo(c);return t}function hideAllCaptchaWrapper(a){var e=a.attr("id").substr("sso_captcha_dialog_container_".length);$("#"+getRecaptchaWrapperID(e)).hide(),$("#"+getGacaptchaWrapperID(e)).hide();var t=$("#"+getShopeeCaptchaWrapperID(e));window.captchaMobileVanilla&&window.captchaMobileVanilla.unmountComponentAtNode(t[0]),t.hide()}function hideCaptchaDialog(a){a.hide(),hideAllCaptchaWrapper(a)}function getCaptchaID(a){return a.attr("id").substr("sso_captcha_dialog_container_".length)}function showDataDomeDialog(a){var e=getRecaptchaWrapperID(getCaptchaID(a));hideAllCaptchaWrapper(a),$("#"+e).show()}var ReCaptchaVerifyCallback=function(a){};function showReCaptchaDialog(a,e){var t=getRecaptchaWrapperID(getCaptchaID(a));hideAllCaptchaWrapper(a),$("#"+t).show(),ReCaptchaVerifyCallback=function(a){e(a)},renderRecaptcha(t,(function(a){ReCaptchaVerifyCallback(a)})),a.show(),centralizeCaptchaDialog(a)}function showGarenaCaptchaDialog(a,e){var t=getGacaptchaWrapperID(getCaptchaID(a));hideAllCaptchaWrapper(a),$("#"+t).show(),a.show(),centralizeCaptchaDialog(a),showCaptcha(),a.find("#proceed-gacaptcha").click((function(){var t=a.find("#line-captcha").find("input").val();e(t,captcha_key)}))}function showShopeeCaptchaDialog(a,e){var t=getShopeeCaptchaWrapperID(getCaptchaID(a));hideAllCaptchaWrapper(a);var c=$("#"+t);c.show(),window.captchaMobileVanilla.renderCaptchaPopupMobile(c[0],{shouldShow:!0,loadCaptchaSdkAsync:function(){return window.captchaSdk},onVerifySuccess:e,onLoadCaptchaSuccess:function(a){},appKey:isMobile()?"Garena.RW":"Garena.PC",scene:"login",onDismiss:function(){window.captchaMobileVanilla.unmountComponentAtNode(c[0]),hideCaptchaDialog(a)},text:{title:_("shopee_captcha_title"),errorScreen:{title:_("shopee_captcha_error_title"),description:_("shopee_captcha_error_description"),retry:_("shopee_captcha_error_retry")},sliderCaptcha:{sliderDescription:_("shopee_captcha_slider_description"),loading:_("shopee_captcha_slider_loading"),retry:_("shopee_captcha_slider_retry"),refresh:_("shopee_captcha_slider_refresh")},imageCaptcha:{refresh:_("shopee_captcha_image_refresh"),inputText:_("shopee_captcha_image_input"),submit:_("shopee_captcha_image_submit"),cancel:_("submit_captcha_image_cancel"),errorWrongInput:_("shopee_captcha_image_wrong"),errorEmptyInput:_("shopee_captcha_image_empty")}},isLiveEnv:!SETTINGS.test}),a.show(),centralizeCaptchaDialog(a)}function requestJsonWithCaptchaDialogProtection(a,e,t,c,r){requestJson(a,e,(function(p,o){403!=o&&("error"in p?"error_require_recaptcha_token"==p.error||"error_recaptcha_token"==p.error?showReCaptchaDialog(r,(function(p){e.recaptcha_token=p,requestJsonWithCaptchaDialogProtection(a,e,t,c,r)})):"error_require_captcha"==p.error?showGarenaCaptchaDialog(r,(function(p,o){e.captcha=p,e.captcha_key=captcha_key,requestJsonWithCaptchaDialogProtection(a,e,t,c,r)})):"error_require_shopee_captcha_token"==p.error||"error_shopee_captcha_token"==p.error?showShopeeCaptchaDialog(r,(function(p){e.shopee_captcha_token=p,requestJsonWithCaptchaDialogProtection(a,e,t,c,r)})):"error_captcha"==p.error?(showError(_("login_error_captcha"),$("#line-captcha")),refreshCaptcha()):(hideCaptchaDialog(r),t(p)):(hideCaptchaDialog(r),t(p)))}),c)}